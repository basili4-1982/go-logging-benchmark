# **Benchmark: Standard `log` vs `zap` Logger in Go**

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é **–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞ Go (`log`) –∏ `zap` (Uber)** –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π
–Ω–∞–≥—Ä—É–∑–∫–µ (10k+ RPS).

üëâ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ `zap` —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 3-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ** –±–ª–∞–≥–æ–¥–∞—Ä—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º—É –≤—ã–≤–æ–¥—É.

---

## **üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/basili4-1982/go-logging-benchmark.git
cd go-logging-benchmark
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
go mod download
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã

- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `log` (–ø–æ—Ä—Ç `:8080`):

```bash
  go run cmd/log-server/main.go
```

- –°–µ—Ä–≤–µ—Ä —Å `zap` (–ø–æ—Ä—Ç `:8081`):

```bash
  go run cmd/zap-server/main.go
```

### 4. –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç (—á–µ—Ä–µ–∑ `wrk`)

- –¢–µ—Å—Ç –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ log (10k RPS):

```bash
  wrk -t12 -c1000 -d10s http://localhost:8080
```

- –¢–µ—Å—Ç –¥–ª—è zap (10k RPS):
```bash
  wrk -t12 -c1000 -d10s http://localhost:8081
```

---

## **üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã**

### **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `log` vs `zap`**

–í–æ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–≤—É—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤:

| **–ú–µ—Ç—Ä–∏–∫–∞**                    | **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `log`** | **–õ–æ–≥–≥–µ—Ä `zap`** | **–†–∞–∑–Ω–∏—Ü–∞**    | **–í—ã–∏–≥—Ä—ã—à** |
|--------------------------------|-----------------------|------------------|----------------|-------------|
| **–û–±—â–µ–µ –∫–æ–ª-–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤**      | 930,868               | 1,610,833        | +679,965       | **+73%**    |
| **–ó–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É (RPS)**   | 92,534.81 RPS         | 159,573.97 RPS   | +67,039.16 RPS | **+72%**    |
| **–°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ (Latency)** | 11.92 –º—Å              | 8.31 –º—Å          | -3.61 –º—Å       | **-30%**    |
| **–ü–∏–∫–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞**           | 117.60 –º—Å             | 164.32 –º—Å        | +46.72 –º—Å      | **+40%**    |
| **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**     | 10.41 MB/s            | 17.96 MB/s       | +7.55 MB/s     | **+72%**    |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (`¬± Stdev`)**   | 57.58%                | 89.60%           | +32.02%        | **+56%**    |

---

### **–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (RPS)**

- `zap` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **–Ω–∞ 72% –±–æ–ª—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤** –≤ —Å–µ–∫—É–Ω–¥—É (159k vs 92k)
- –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Å `zap` –º–æ–∂–µ—Ç –≤—ã–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à—É—é –Ω–∞–≥—Ä—É–∑–∫—É

2. **–ó–∞–¥–µ—Ä–∂–∫–∏ (Latency)**

- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ —Å `zap` **–Ω–∞ 30% –º–µ–Ω—å—à–µ** (8.31 –º—Å vs 11.92 –º—Å)
- –û–¥–Ω–∞–∫–æ –ø–∏–∫–æ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —É `zap` –≤—ã—à–µ (164 –º—Å vs 117 –º—Å) ‚Äî —ç—Ç–æ –ø–ª–∞—Ç–∞ –∑–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã**

- `zap` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é —Ä–∞–±–æ—Ç—É**:
    - 89.6% –∑–∞–ø—Ä–æ—Å–æ–≤ —É–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ `avg ¬± stdev` (–ø—Ä–æ—Ç–∏–≤ 57.58% —É `log`)
    - –ú–µ–Ω—å—à–∏–π —Ä–∞–∑–±—Ä–æ—Å –∑–Ω–∞—á–µ–Ω–∏–π `Req/Sec`

4. **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**

- `zap` –ø–µ—Ä–µ–¥–∞–µ—Ç **–Ω–∞ 72% –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö** –≤ —Å–µ–∫—É–Ω–¥—É (17.96 MB/s vs 10.41 MB/s)

---

### **–ò—Ç–æ–≥: –ö–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**

- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `log`**  
  –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:  
  ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏  
  ‚úÖ –ü—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π (< 1k RPS)  
  ‚ùå –ù–µ –≥–æ–¥–∏—Ç—Å—è –¥–ª—è production-—Å–µ—Ä–≤–∏—Å–æ–≤

- **–õ–æ–≥–≥–µ—Ä `zap`**  
  –û–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è:  
  ‚úÖ Highload-–ø—Ä–æ–µ–∫—Ç–æ–≤  
  ‚úÖ –ü—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, API, –±—ç–∫–µ–Ω–¥—ã)  
  ‚úÖ –°–∏—Å—Ç–µ–º, –≥–¥–µ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**  
–î–ª—è –ª—é–±–æ–≥–æ —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Go —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `log` ‚Äî —ç—Ç–æ –±—É—Ç—ã–ª–æ—á–Ω–æ–µ –≥–æ—Ä–ª—ã—à–∫–æ.
`zap` –¥–∞–µ—Ç **–ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ 72%** –∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–±–æ—Ä–æ–º
–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è production-–∫–æ–¥–∞.

---

## **üìå –ü–æ—á–µ–º—É `zap` –±—ã—Å—Ç—Ä–µ–µ?**

- **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî –ª–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –ø–∞—á–∫–∞–º–∏, –∞ –Ω–µ –ø–æ –æ–¥–Ω–æ–º—É.
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-–≤—ã–≤–æ–¥** ‚Äî –º–µ–Ω—å—à–µ –∞–ª–ª–æ–∫–∞—Ü–∏–π –ø–∞–º—è—Ç–∏.

---

## **üõ† –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**

```
.
‚îú‚îÄ‚îÄ cmd
‚îÇ   ‚îú‚îÄ‚îÄ log-server/  # –°–µ—Ä–≤–µ—Ä —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º log
‚îÇ   ‚îî‚îÄ‚îÄ zap-server/  # –°–µ—Ä–≤–µ—Ä —Å zap
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ go.mod
```

---

## **üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã**

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è `zap`](https://pkg.go.dev/go.uber.org/zap)
- [–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `zap` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞](https://github.com/uber-go/zap/blob/master/FAQ.md)
- [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ª–æ–≥–≥–µ—Ä–æ–≤ –≤ Go](https://github.com/rs/zerolog#benchmarks)

---

**–õ–∏—Ü–µ–Ω–∑–∏—è**: MIT